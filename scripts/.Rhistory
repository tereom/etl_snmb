calcular_hipervolumen(2, 10000)[[1]]
calcular_hipervolumen(2, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
(4/3)*pi
(4/3)*pi
(4/3)*pi
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(3, 10000)[[1]]
calcular_hipervolumen(2, 10000)[[1]]
h <- llply(calcular_hipervolumen(3, 10000)[[2]], aux)
h
h_media <- h %>%
as.numeric() %>%
mean()
h_media
4/3
p_sublimado_esfera <- map2(p, h, c)
p <- calcular_hipervolumen(3, 10000)[[2]]
h <- llply(p, aux)
h_media <- h %>%
as.numeric() %>%
mean()
p_sublimado_esfera <- map2(p, h, c)
p_sublimado_esfera
llply(p_sublimado_esfera, function(x), sum(x^2))
llply(p_sublimado_esfera, function(x) sum(x^2))
llply(p_sublimado_esfera, function(x) sum(x^2)) %>% as_numeric()
llply(p_sublimado_esfera, function(x) sum(x^2)) %>% as.numeric()
p_sublimado_bola <- llply(p_sublimado_esfera, function(x){
h_max <- x[length(x)]
# ahora calculando para x una altura h_sim, de tal forma que (x, h_sim)
# pertenezca a la bola unitaria de dimensión d
h_sim <- runif(1, -h_max, h_max)
# regresando, el nuevo punto
return(c(x[-length(x)], h_sim))
})
llply(p_sublimado_bola, function(x) sum(x^2)) %>% as.numeric()
llply(p_sublimado_bola, function(x) sum(x^2)) %>% as.numeric() %>% hist()
calcular_hipervolumen(1, 10)
g['gato'] <- 'perro'
g<- list()
g['gato'] <- 'perro'
g
g['rata'] <- function(x) return x
g['rata'] <- function(x){return x}
ceiling(2.6)
tf * 10
tf <- 120
tf * 10
duracion_acumulada <- 0:(tf * 10)
duracion_acumulada
?list2env
5%2
5%%3
5%%2
library(ggplot2)
qplot(uptake, data = CO2) +
xlab(bquote('Assimilation ('*mu~ 'mol' ~CO[2]~ m^-2~s^-1*')'))
library(ggplot2)
qplot(uptake, data = CO2) +
xlab(bquote('Assimilation ('*mu~ 'mol' ~Km[2]~ m^-2~s^-1*')'))
library(ggplot2)
qplot(uptake, data = CO2) +
xlab(bquote('Assimilation ('*mu~ 'mol' ~Km^2~s^-1*')'))
library("readr")
library("plyr")
library("dplyr")
archivos_db <- read_csv("~/Desktop/archivos_74188_db.csv")
problems()
library("readr")
library("plyr")
library("lubridate")
library("dplyr")
archivos_db <- read.csv("~/Desktop/archivos_74188_db.csv")
archivos_db
glimpse(archivos_db)
archivos_db <- read_csv("~/Desktop/archivos_74188_db.csv")
archivos_db <- read.csv("~/Desktop/archivos_74188_db.csv", stringsAsFactors = FALSE)
glimpse(archivos_db)
archivos_entrega <- read_csv("~/Desktop/archivos_74188.csv")
archivos_entrega
archivos_entrega <- read_csv("~/Desktop/archivos_74188.csv", col_names = FALSE)
archivos_entrega
archivos_anexos <- read_csv("~/Desktop/archivos_74188.csv", col_names = FALSE)
?inner_join
c(1,2,3)
archivos_anexos
archivos_repetidos <- archivos_db %>%
inner_join(archivos_anexos, by = c("archivo_nombre_original" = "X1"))
archivos_repetidos
archivos_db$archivo_nombre_original
c("archivo_nombre_original" = "X1")
archivos_repetidos <- archivos_db %>%
inner_join(archivos_anexos, by = c("archivo_nombre_original" = "X1"))
archivos_repetidos
archivos_db$archivo_nombre_original
archivos_anexos$X1
archivos_db$archivo_nombre_original
archivos_anexos$X1
60*2500
60*3
60*3*2500
40*3*2500
40*3*25
15*3*2500
75000+150000+25000+450000+50000+300000+112500
(40*4+25)*6
29*4045
10*3+20*3+5*2+60*3+20*1+40*3+15*3
465+2500
465*2500
502500/6
83750/3
502500+41000
(502500+41000)
(502500+41000)/6
502500+41000
50250076
502500/6
502500/18
27916*.9
22*.7
18*2/3
20*2500
0.011*2.54
var <- "gato"
fun <- function(){
print(var)
}
fum()
fun()
library("plyr")
library("dplyr")
library("readr")
Archivo_camara <- read_csv("~/Desktop/nombres_estructura_snmb/productos/Archivo_camara_nombres_nuevos.csv")
colisiones_camara.archivo <- Archivo_camara %>%
group_by(archivo) %>%
tally() %>%
filter(n >= 2)
Archivo_camara
nrow(colisiones_camara.archivo)
colisiones_camara.archivo_nombre_estructura <- Archivo_camara %>%
group_by(archivo_nombre_estructura) %>%
tally() %>%
filter(n >= 2)
nrow(colisiones_camara.archivo_nombre_estructura)
Archivo_grabadora <- read_csv("~/Desktop/nombres_estructura_snmb/productos/Archivo_grabadora_nombres_nuevos.csv")
colisiones_grabadora.archivo <- Archivo_grabadora %>%
group_by(archivo) %>%
tally() %>%
filter(n >= 2)
nrow(colisiones_grabadora.archivo)
colisiones_grabadora.archivo_nombre_estructura <- Archivo_grabadora %>%
group_by(archivo_nombre_estructura) %>%
tally() %>%
filter(n >= 2)
nrow(colisiones_grabadora.archivo_nombre_estructura)
View(Archivo_camara[1000:2000,])
View(Archivo_camara[6000:7000,])
nchar("1234567890abcdf")
nchar("1234567890abcdef")
16^16
library("readr")
library("plyr")
library("dplyr")
library("readr")
library("plyr")
library("dplyr")
tabla <- read_csv('~/Downloads/anp_cgl.csv')
tabla
tabla <- read_csv('~/Downloads/anp_cgl.csv') %>%
arrange(anp)
View(tabla)
103+101+88+35+386+82+115+78+99+97+73+92+90+35+53+43+43+58+105+101+52+79+41+108+88
2700*8
12000+12000
2700*8
216000+4000
21600+4000
25600/6
365/(27*4)
setwd("~/Desktop/conabio/etl_snmb/scripts")
library(plyr)
library(dplyr)
library(tidyr)
library(stringi)
library(RSQLite)
library(RPostgreSQL)
base_input <- src_sqlite("../datos/2016_11_09.sqlite")
tablas <- src_tbls(base_input)
datos <- llply(tablas, function(nombre, base){
collect(tbl(base, nombre), n = Inf)
}, base = base_input)
names(datos) <- tablas
colnames(datos$Transecto_especies_invasoras_muestra)
colnames(datos$Transecto_huellas_excretas_muestra)
nrow(datos$Transecto_especies_invasoras_muestra)
datos$Transecto_especies_invasoras_muestra %>%
select(
conglomerado_muestra_id,
transecto_numero
) %>%
unique() %>%
nrow()
datos$Transecto_especies_invasoras_muestra %>%
group_by(conglomerado_muestra_id, transecto_numero) %>%
tally() %>%
arrange(desc(n))
datos$Transecto_especies_invasoras_muestra %>%
filter(conglomerado_muestra_id == 813, transecto_numero == "Transecto 4")
nrow(datos$Transecto_huellas_excretas_muestra) == datos$Transecto_huellas_excretas_muestra %>%
select(
conglomerado_muestra_id,
transecto_numero
) %>%
unique() %>%
nrow()
# Difieren en 1 los números de registros, quiere decir que hay un muestreo de transecto con
# mismo "conglomerado_muestra_id" y "transecto_numero" registrado dos veces.
# Revisando:
datos$Transecto_huellas_excretas_muestra %>%
group_by(conglomerado_muestra_id, transecto_numero) %>%
tally() %>%
arrange(desc(n))
table(datos$Transecto_huellas_excretas_muestra$comentario)
true | FALSE
TRUE | FALSE
datos$Transecto_huellas_excretas_muestra %>%
select(comentario) %>%
filter(is.na(comentario) | comentario == "")
datos$Transecto_huellas_excretas_muestra %>%
select(comentario) %>%
filter(is.na(comentario) | comentario == "") %>%
View()
datos$Transecto_huellas_excretas_muestra %>%
select(comentario) %>%
filter(is.na(comentario) | comentario == "") %>%
is.na()
datos$Transecto_huellas_excretas_muestra %>%
select(comentario) %>%
filter(is.na(comentario) | comentario == "") %>%
is.na() %>%
sum()
Transecto_muestra_aux <- datos$Transecto_especies_invasoras_muestra %>%
filter(id != 881) %>%
full_join(datos$Transecto_huellas_excretas_muestra %>%
filter(id != 1409),
by = c("conglomerado_muestra_id", "transecto_numero"),
suffix = c(".invasoras", ".huellas_excretas"))
View(Transecto_muestra_aux)
df <- data_frame(x = c(1, 2, NA), y = c("a", NA, "b"))
df
df %>% replace_na(list(x = 0, y = "unknown"))
df %>% replace_na(list(x = 0))
Transecto_muestra_aux <- datos$Transecto_especies_invasoras_muestra %>%
filter(id != 881) %>%
full_join(datos$Transecto_huellas_excretas_muestra %>%
filter(id != 1409),
by = c("conglomerado_muestra_id", "transecto_numero"),
suffix = c(".invasoras", ".huellas_excretas")) %>%
replace_na(list(comentario.invasoras = "", comentario.huellas_excretas = "")) %>%
transmute(
transecto_muestra_id = 1:nrow(.),
conglomerado_muestra_id = conglomerado_muestra_id,
transecto_numero = transecto_numero,
existe = "T",
fecha = ifelse(!is.na(fecha.invasoras), fecha.invasoras, fecha.huellas_excretas),
hora_inicio = ifelse(!is.na(hora_inicio.invasoras), hora_inicio.invasoras, hora_inicio.huellas_excretas),
hora_termino = ifelse(!is.na(hora_termino.invasoras), hora_termino.invasoras, hora_termino.huellas_excretas),
tecnico = ifelse(!is.na(tecnico.invasoras), tecnico.invasoras, tecnico.huellas_excretas),
comentario = paste0(comentario.invasoras, " ", comentario.huellas_excretas),
Transecto_especies_invasoras_id = id.invasoras,
Transecto_huellas_excretas_id = id.huellas_excretas
)
View(Transecto_muestra_aux)
Transecto_muestra_aux <- datos$Transecto_especies_invasoras_muestra %>%
filter(id != 881) %>%
full_join(datos$Transecto_huellas_excretas_muestra %>%
filter(id != 1409),
by = c("conglomerado_muestra_id", "transecto_numero"),
suffix = c(".invasoras", ".huellas_excretas")) %>%
replace_na(list(comentario.invasoras = "", comentario.huellas_excretas = "")) %>%
transmute(
transecto_muestra_id = 1:nrow(.),
conglomerado_muestra_id = conglomerado_muestra_id,
transecto_numero = transecto_numero,
existe = "T",
fecha = ifelse(!is.na(fecha.invasoras), fecha.invasoras, fecha.huellas_excretas),
hora_inicio = ifelse(!is.na(hora_inicio.invasoras), hora_inicio.invasoras, hora_inicio.huellas_excretas),
hora_termino = ifelse(!is.na(hora_termino.invasoras), hora_termino.invasoras, hora_termino.huellas_excretas),
tecnico = ifelse(!is.na(tecnico.invasoras), tecnico.invasoras, tecnico.huellas_excretas),
comentario = paste0(comentario.invasoras, comentario.huellas_excretas),
Transecto_especies_invasoras_id = id.invasoras,
Transecto_huellas_excretas_id = id.huellas_excretas
)
Transecto_muestra_aux <- datos$Transecto_especies_invasoras_muestra %>%
filter(id != 881) %>%
full_join(datos$Transecto_huellas_excretas_muestra %>%
filter(id != 1409),
by = c("conglomerado_muestra_id", "transecto_numero"),
suffix = c(".invasoras", ".huellas_excretas")) %>%
replace_na(list(comentario.invasoras = "", comentario.huellas_excretas = ""))
View(Transecto_muestra_aux)
# Construyendo "Transecto_muestra_aux" a partir de los dos anteriores:
Transecto_muestra_aux <- datos$Transecto_especies_invasoras_muestra %>%
filter(id != 881) %>%
full_join(datos$Transecto_huellas_excretas_muestra %>%
filter(id != 1409),
by = c("conglomerado_muestra_id", "transecto_numero"),
suffix = c(".invasoras", ".huellas_excretas")) %>%
replace_na(list(comentario.invasoras = "", comentario.huellas_excretas = "")) %>%
transmute(
transecto_muestra_id = 1:nrow(.),
conglomerado_muestra_id = conglomerado_muestra_id,
transecto_numero = transecto_numero,
existe = "T",
fecha = ifelse(!is.na(fecha.invasoras), fecha.invasoras, fecha.huellas_excretas),
hora_inicio = ifelse(!is.na(hora_inicio.invasoras), hora_inicio.invasoras, hora_inicio.huellas_excretas),
hora_termino = ifelse(!is.na(hora_termino.invasoras), hora_termino.invasoras, hora_termino.huellas_excretas),
tecnico = ifelse(!is.na(tecnico.invasoras), tecnico.invasoras, tecnico.huellas_excretas),
comentario = paste0(comentario.invasoras, comentario.huellas_excretas),
Transecto_especies_invasoras_id = id.invasoras,
Transecto_huellas_excretas_id = id.huellas_excretas
)
View(Transecto_muestra_aux)
Transecto_muestra_aux %>%
group_by(conglomerado_muestra_id, transecto_numero) %>%
tally() %>%
arrange(desc(n))
View(datos$Especie_invasora)
?anti_join
Especie_invasora_nueva <- datos$Especie_invasora %>%
anti_join(Transecto_muestra_aux, by = Transecto_especies_invasoras_id)
Transecto_muestra_aux <- datos$Transecto_especies_invasoras_muestra %>%
filter(id != 881) %>%
full_join(datos$Transecto_huellas_excretas_muestra %>%
filter(id != 1409),
by = c("conglomerado_muestra_id", "transecto_numero"),
suffix = c(".invasoras", ".huellas_excretas")) %>%
replace_na(list(comentario.invasoras = "", comentario.huellas_excretas = "")) %>%
transmute(
transecto_muestra_id = 1:nrow(.),
conglomerado_muestra_id = conglomerado_muestra_id,
transecto_numero = transecto_numero,
existe = "T",
fecha = ifelse(!is.na(fecha.invasoras), fecha.invasoras, fecha.huellas_excretas),
hora_inicio = ifelse(!is.na(hora_inicio.invasoras), hora_inicio.invasoras, hora_inicio.huellas_excretas),
hora_termino = ifelse(!is.na(hora_termino.invasoras), hora_termino.invasoras, hora_termino.huellas_excretas),
tecnico = ifelse(!is.na(tecnico.invasoras), tecnico.invasoras, tecnico.huellas_excretas),
comentario = paste0(comentario.invasoras, comentario.huellas_excretas),
transecto_especies_invasoras_id = id.invasoras,
transecto_huellas_excretas_id = id.huellas_excretas
)
View(Transecto_muestra_aux)
Transecto_muestra_aux %>%
group_by(conglomerado_muestra_id, transecto_numero) %>%
tally() %>%
arrange(desc(n))
#  Todo bien
Especie_invasora_nueva <- datos$Especie_invasora %>%
anti_join(Transecto_muestra_aux, by = transecto_especies_invasoras_id)
datos$Especie_invasora
Especie_invasora_nueva <- datos$Especie_invasora %>%
anti_join(Transecto_muestra_aux, by = "transecto_especies_invasoras_id")
Especie_invasora_nueva
Especie_invasora_nueva <- datos$Especie_invasora %>%
left_join(Transecto_muestra_aux, by = "transecto_especies_invasoras_id")
Especie_invasora_nueva
Especie_invasora_nueva <- datos$Especie_invasora %>%
left_join(Transecto_muestra_aux %>%
select(
transecto_muestra_id,
transecto_especies_invasoras_id
), by = "transecto_especies_invasoras_id")
View(Especie_invasora_nueva)
Especie_invasora_nueva <- datos$Especie_invasora %>%
left_join(Transecto_muestra_aux %>%
select(
transecto_muestra_id,
transecto_especies_invasoras_id
), by = "transecto_especies_invasoras_id") %>%
select(-transecto_especies_invasoras_id)
View(Especie_invasora_nueva)
datos$Huella_excreta %>%
anti_join(Transecto_muestra_aux %>%
select(
transecto_muestra_id,
transecto_huellas_excretas_id
), by = "transecto_huellas_excretas_id")
Huella_excreta_nueva <- datos$Huella_excreta %>%
left_join(Transecto_muestra_aux %>%
select(
transecto_muestra_id,
transecto_huellas_excretas_id
), by = "transecto_huellas_excretas_id") %>%
select(-transecto_huellas_excretas_id)
View(Huella_excreta_nueva)
Transecto_muestra_aux <- datos$Transecto_especies_invasoras_muestra %>%
# filtrando registros duplicados
filter(id != 881) %>%
# haciendo el join bilateral por "conglomerado_muestra_id" y "transecto_numero"
full_join(datos$Transecto_huellas_excretas_muestra %>%
# con los datos filtrados
filter(id != 1409),
by = c("conglomerado_muestra_id", "transecto_numero"),
suffix = c(".invasoras", ".huellas_excretas")) %>%
# quitando NA's artefacto de los comentarios.
replace_na(list(comentario.invasoras = "", comentario.huellas_excretas = "")) %>%
# obteniendo los campos necesarios para "Transecto_muestra"
transmute(
transecto_muestra_id = 1:nrow(.),
conglomerado_muestra_id = conglomerado_muestra_id,
transecto_numero = transecto_numero,
existe = "T",
fecha = ifelse(!is.na(fecha.invasoras), fecha.invasoras, fecha.huellas_excretas),
hora_inicio = ifelse(!is.na(hora_inicio.invasoras), hora_inicio.invasoras, hora_inicio.huellas_excretas),
hora_termino = ifelse(!is.na(hora_termino.invasoras), hora_termino.invasoras, hora_termino.huellas_excretas),
tecnico = ifelse(!is.na(tecnico.invasoras), tecnico.invasoras, tecnico.huellas_excretas),
comentario = paste0(comentario.invasoras, comentario.huellas_excretas),
transecto_especies_invasoras_id = id.invasoras,
transecto_huellas_excretas_id = id.huellas_excretas
)
View(Transecto_muestra_aux)
Transecto_muestra_aux %>%
group_by(conglomerado_muestra_id, transecto_numero) %>%
tally() %>%
arrange(desc(n))
Especie_invasora_nueva <- datos$Especie_invasora %>%
left_join(Transecto_muestra_aux %>%
select(
transecto_muestra_id,
transecto_especies_invasoras_id
), by = "transecto_especies_invasoras_id") %>%
select(-transecto_especies_invasoras_id)
Especie_invasora_nueva
datos$Especie_invasora
nrow(Especie_invasora_nueva) == nrow(datos$Especie_invasora)
Huella_excreta_nueva <- datos$Huella_excreta %>%
left_join(Transecto_muestra_aux %>%
select(
transecto_muestra_id,
transecto_huellas_excretas_id
), by = "transecto_huellas_excretas_id") %>%
select(-transecto_huellas_excretas_id)
nrow(Huella_excreta_nueva) == nrow(datos$Huella_excreta)
View(Huella_excreta_nueva)
Huella_excreta_nueva <- datos$Huella_excreta %>%
left_join(Transecto_muestra_aux %>%
select(
transecto_muestra_id,
transecto_huellas_excretas_id
), by = "transecto_huellas_excretas_id") %>%
select(-transecto_huellas_excretas_id)
Huella_excreta_nueva
sum(is.na(Especie_invasora_nueva$transecto_muestra_id))
sum(is.na(Huella_excreta_nueva$transecto_muestra_id))
glimpse(Transecto_muestra_aux)
Transecto_muestra_nueva <- Transecto_muestra_aux %>%
mutate(
id = transecto_muestra_id
) %>%
select(
-transecto_muestra_id,
-transecto_especies_invasoras_id,
-transecto_huellas_excretas_id
)
View(Transecto_muestra_nueva)
Avistamiento_aves_nueva <- datos$Conteo_ave
Avistamiento_aves_nueva
View(datos$Archivo_conteo_ave)
Archivo_avistamiento_aves_nueva <- datos$Archivo_conteo_ave %>%
select(
id,
avistamiento_aves_id = conteo_ave_id,
archivo_nombre_original,
archivo
)
Archivo_avistamiento_aves_nueva
Arbol_cuadrante_nueva <- datos$Arbol_cuadrante
View(datos$Arbol_cuadrante)
Arbol_cuadrante_nueva <- datos$Arbol_cuadrante %>%
mutate(
cambios = rep(NA, nrow(.)),
forma_vida = rep(NA, nrow(.)),
diametro_normal = as.character(diametro_normal)
)
View(Arbol_cuadrante_nueva)
class(Arbol_cuadrante_nueva$diametro_normal)
Arbol_cuadrante_nueva <- datos$Arbol_cuadrante %>%
mutate(
cambios = rep("", nrow(.)),
forma_vida = rep("", nrow(.)),
diametro_normal = as.character(diametro_normal)
)
View(Arbol_cuadrante_nueva)
